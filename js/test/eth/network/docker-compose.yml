version: '3'

services:
  proofServer1:
    image: appliedblockchain/zktrading-server:$CIRCLE_BRANCH-$CIRCLE_SHA1
    command: 7 /tmp/k0keys/commitment_pk /tmp/k0keys/commitment_vk /tmp/k0keys/addition_pk /tmp/k0keys/addition_vk /tmp/k0keys/transfer_pk /tmp/k0keys/transfer_vk /tmp/k0keys/withdrawal_pk /tmp/k0keys/withdrawal_vk 4000
    restart: on-failure
    volumes:
      - /tmp/k0keys/:/tmp/k0keys:ro
    ports:
      - 4000:4000
    networks:
      - main
  proofServer2:
    image: appliedblockchain/zktrading-server:$CIRCLE_BRANCH-$CIRCLE_SHA1
    command: 7 /tmp/k0keys/commitment_pk /tmp/k0keys/commitment_vk /tmp/k0keys/addition_pk /tmp/k0keys/addition_vk /tmp/k0keys/transfer_pk /tmp/k0keys/transfer_vk /tmp/k0keys/withdrawal_pk /tmp/k0keys/withdrawal_vk 5000
    restart: on-failure
    volumes:
      - /tmp/k0keys/:/tmp/k0keys:ro
    ports:
      - 5000:5000
    networks:
      - main
  proofServer3:
    image: appliedblockchain/zktrading-server:$CIRCLE_BRANCH-$CIRCLE_SHA1
    command: 7 /tmp/k0keys/commitment_pk /tmp/k0keys/commitment_vk /tmp/k0keys/addition_pk /tmp/k0keys/addition_vk /tmp/k0keys/transfer_pk /tmp/k0keys/transfer_vk /tmp/k0keys/withdrawal_pk /tmp/k0keys/withdrawal_vk 6000
    restart: on-failure
    volumes:
      - /tmp/k0keys/:/tmp/k0keys:ro
    ports:
      - 6000:6000
    networks:
      - main
  mtServer1:
    image: appliedblockchain/zktrading-mtserver:$CIRCLE_BRANCH-$CIRCLE_SHA1
    command: 7 4100
    restart: on-failure
    volumes:
      - /tmp/k0keys/:/tmp/k0keys:ro
    ports:
      - 4100:4100
    networks:
      - main
  mtServer2:
    image: appliedblockchain/zktrading-mtserver:$CIRCLE_BRANCH-$CIRCLE_SHA1
    command: 7 5100
    restart: on-failure
    volumes:
      - /tmp/k0keys/:/tmp/k0keys:ro
    ports:
      - 5100:5100
    networks:
      - main
  mtServer3:
    image: appliedblockchain/zktrading-mtserver:$CIRCLE_BRANCH-$CIRCLE_SHA1
    command: 7 6100
    restart: on-failure
    volumes:
      - /tmp/k0keys/:/tmp/k0keys:ro
    ports:
      - 6100:6100
    networks:
      - main
  parity:
    image: appliedblockchain/parity-solo-instant:latest
    restart: unless-stopped
    volumes:
      - parity:/solo/chains
    ports:
      - 8545:8545
      - 8546:8546
    networks:
      - main
volumes:
  parity:
networks:
  main:
    
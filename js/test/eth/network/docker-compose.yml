version: '3'

services:
  server1:
    image: zktrading-server
    build:
      context: ../../../../cpp
      dockerfile: docker/server.Dockerfile
    command: 4 /tmp/k0keys/commitment_pk /tmp/k0keys/commitment_vk /tmp/k0keys/addition_pk /tmp/k0keys/addition_vk /tmp/k0keys/transfer_pk /tmp/k0keys/transfer_vk /tmp/k0keys/withdrawal_pk /tmp/k0keys/withdrawal_vk /tmp/k0keys/example_pk /tmp/k0keys/example_vk 4000
    restart: on-failure
    volumes:
      - /tmp/k0keys:/tmp/k0keys:ro
    ports:
      - 4000:4000
    networks:
      - main
  mtserver1:
    image: zktrading-mtserver
    build:
      context: ../../../../cpp
      dockerfile: docker/mtserver.Dockerfile
    command: 4 4100
    restart: on-failure
    ports:
      - 4100:4100
    networks:
      - main
  mtserver2:
    image: zktrading-mtserver
    build:
      context: ../../../../cpp
      dockerfile: docker/mtserver.Dockerfile
    command: 4 5100
    restart: on-failure
    ports:
      - 5100:5100
    networks:
      - main
  mtserver3:
    image: zktrading-mtserver
    build:
      context: ../../../../cpp
      dockerfile: docker/mtserver.Dockerfile
    command: 4 6100
    restart: on-failure

    ports:
      - 6100:6100
    networks:
      - main
  parity:
    image: appliedblockchain/parity-solo-instant:latest
    restart: unless-stopped
    ports:
      - 8545:8545
      - 8546:8546
    networks:
      - main
networks:
  main:
